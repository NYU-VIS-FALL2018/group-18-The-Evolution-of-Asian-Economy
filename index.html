<html>
<head>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <style>
        h1 {
            background-color: lightgray;
            text-align: center;
        }

        p, h3 {
            margin-left: 750px;
        }

        svg {
            border: solid 1px black;
            background-color: white;
        }

        .column {
            float: left;
        }

        .clearfix {
            padding-bottom: 15px;
            background-color: #F0F0E1;
        }

            .clearfix::after {
                content: "";
                clear: both;
                display: table;
            }

        .sticky {
            position: fixed;
            width: 99%;
            top: -10px;
            background-color: #F0F0E1;
        }

        .nonsticky {
            margin-top: 490px;
        }

        .line_india {
            fill: none;
            stroke: orange;
        }

        .line_china {
            fill: none;
            stroke: blue;
        }

        .line_japan {
            fill: none;
            stroke: red;
        }

        .country-name {
            margin: 0 !important;
        }

        .key-dot {
            display: inline-block;
            height: 10px;
            margin-right: .5em;
            width: 10px;
        }

        .legend1 {
            text-align: left;
            margin-left: 750px;
        }


        .india {
            background: orange;
        }

        .china {
            background: blue;
        }

        .japan {
            background: red;
        }
    </style>
    <title>The Evolution of Asian Economy</title>
</head>
<body style="background-color:#F0F0E1">

    <div class="clearfix" id="GDP">
        <h1>The Evolution of Asian Economy</h1>
        <h2> Q1: GDP of major countries </h2>
        <svg id="container1" height="330" width="700" class="column">
            <g id="body" transform="translate(150,20)"></g>
            <div class="legend1">
                <p class="country-name">
                    <span class="key-dot india"></span>India <span class="key-dot china"></span>China
                    <span class="key-dot japan"></span>Japan
                </p>
            </div>
        </svg>
        <h3>
            In this project, we are taking a look at the Asian economy. We will be focusing on some of the major countries in that region. We have some hypothesis on what changes there are over the past few decades and what might be the causes, and we will use data to validate our hypothesis. Overall, this will help us to gain a better understanding of the evolution the economy of that region.
        </h3>
        <h3>
            First, we start off by taking a look at some of the major countries and see how their economy have been doing over the past few decades.
        </h3>
    </div>
    <div id="rest">
        <div class="clearfix" id="Q2">
            <h2> Q2:</h2>
            <svg id="container3" height="330" width="700" class="column">
                
            </svg>
            <h3>
                Description
            </h3>
        </div>
        <div class="clearfix" id="Q3">
            <h2> Q3: % of GDP on Research and Development</h2>
            <svg id="container3" height="330" width="700" class="column">
                <g id="body3" transform="translate(150,20)"></g>
                <div class="legend1">
                    <p class="country-name">
                        <span class="key-dot india"></span>India <span class="key-dot china"></span>China
                        <span class="key-dot japan"></span>Japan
                    </p>
                </div>
            </svg>
            <h3>
                Description
            </h3>
        </div>
        <div class="clearfix" id="Q4">
            <h2> Q4:</h2>
            <svg id="container3" height="330" width="700" class="column">

            </svg>
            <h3>
                Description
            </h3>
        </div>
        <div class="clearfix" id="Q5">
            <h2> Q5: Focus on Healthcare </h2>
            <svg id="container5" height="330" width="700" class="column">
                <g id="body5" transform="translate(150,20)"></g>
                <div class="legend1">
                    <p class="country-name">
                        <span class="key-dot india"></span>India <span class="key-dot china"></span>China
                        <span class="key-dot japan"></span>Japan
                    </p>
                </div>
            </svg>
            <h3>
                Description
            </h3>
        </div>
</body>
<script>
    // code to make a section stick to the top of the page when scrolling
    window.onscroll = function () { myFunction() };
    var header = document.getElementById("GDP");
    var sticky = header.offsetTop;

    function myFunction() {
        if (window.pageYOffset > sticky) {
            header.classList.add("sticky");
            document.getElementById("rest").classList.add("nonsticky");
        } else {
            header.classList.remove("sticky");
            document.getElementById("rest").classList.remove("nonsticky");
        }

        // snaps to Q5 when scrolling, this code can potentially be used to create a scroll-snap effect
        /*if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
            location.href = "#Q5";
        } */
    }

    // d3 part
    let body = d3.select('#body')

    let bodyHeight = 250
    let bodyWidth = 500
    d3.csv("ques1_v2.csv").then(showData)
    function showData(data) {

        let maxValue_china = d3.max(data, d => d.China)
        let maxValue_india = d3.max(data, d => d.India)
        let maxValue_japan = d3.max(data, d => d.Japan)

        let maxValue = Math.max(maxValue_china, maxValue_india, maxValue_japan)
        let yScale = d3.scaleLinear()
            .range([bodyHeight, 0])
            .domain([0, 12237700000000]);
        let xScale = d3.scaleLinear()
            .domain(d3.extent(data, d => d.Year))
            .range([0, bodyWidth])

        console.log(xScale);
        body.append("g")
            .call(d3.axisLeft(yScale))
            .append("text")
            .text("value")
            .attr("fill", "black")
            .attr("transform", `rotate(270,${0},${110})`)

        body.append("g")
            .attr("transform", "translate(0," + bodyHeight + ")")
            .call(d3.axisBottom(xScale))
            .append("text")
            .text("Year")
            .attr("fill", "black")
            .attr("dx", bodyWidth / 2)
            .attr("dy", 50)

        valueline_india = d3.line()
            .x(d => xScale(d.Year))
            .y(d => yScale(d.India))
        body.append("path")
            .datum(data)
            .attr("d", d => valueline_india(d))
            .attr("class", "line_india")
        valueline_china = d3.line()
            .x(d => xScale(d.Year))
            .y(d => yScale(d.China))
        body.append("path")
            .datum(data)
            .attr("d", d => valueline_china(d))
            .attr("class", "line_china")
        valueline_japan = d3.line()
            .x(d => xScale(d.Year))
            .y(d => yScale(d.Japan))
        body.append("path")
            .datum(data)
            .attr("d", d => valueline_japan(d))
            .attr("class", "line_japan")
    }



    let body3 = d3.select('#body3')
    d3.csv("ques_3.csv").then(showData3)
    function showData3(data) {

        let maxValue_china = d3.max(data, d => d.China)
        let maxValue_india = d3.max(data, d => d.India)
        let maxValue_japan = d3.max(data, d => d.Japan)

        let maxValue = Math.max(maxValue_china, maxValue_india, maxValue_japan)
        let yScale = d3.scaleLinear()
            .range([bodyHeight, 0])
            .domain([0, maxValue]);
        let xScale = d3.scaleLinear()
            .domain(d3.extent(data, d => d.Year))
            .range([0, bodyWidth])

        console.log(xScale);
        body3.append("g")
            .call(d3.axisLeft(yScale))
            .append("text")
            .text("value")
            .attr("fill", "black")
            .attr("transform", `rotate(270,${0},${110})`)

        body3.append("g")
            .attr("transform", "translate(0," + bodyHeight + ")")
            .call(d3.axisBottom(xScale))
            .append("text")
            .text("Year")
            .attr("fill", "black")
            .attr("dx", bodyWidth / 2)
            .attr("dy", 50)

        valueline_india = d3.line()
            .x(d => xScale(d.Year))
            .y(d => yScale(d.India))
        body3.append("path")
            .datum(data)
            .attr("d", d => valueline_india(d))
            .attr("class", "line_india")
        valueline_china = d3.line()
            .x(d => xScale(d.Year))
            .y(d => yScale(d.China))
        body3.append("path")
            .datum(data)
            .attr("d", d => valueline_china(d))
            .attr("class", "line_china")
        valueline_japan = d3.line()
            .x(d => xScale(d.Year))
            .y(d => yScale(d.Japan))
        body3.append("path")
            .datum(data)
            .attr("d", d => valueline_japan(d))
            .attr("class", "line_japan")
    }

    let body5 = d3.select('#body5')
    d3.csv("ques5.csv").then(showData1)
    function showData1(data) {

        let maxValue_china = d3.max(data, d => d.China)
        let maxValue_india = d3.max(data, d => d.India)
        let maxValue_japan = d3.max(data, d => d.Japan)

        let maxValue = Math.max(maxValue_china, maxValue_india, maxValue_japan)
        let yScale = d3.scaleLinear()
            .range([bodyHeight, 0])
            .domain([0, maxValue]);
        let xScale = d3.scaleLinear()
            .domain(d3.extent(data, d => d.Year))
            .range([0, bodyWidth])

        console.log(xScale);
        body5.append("g")
            .call(d3.axisLeft(yScale))
            .append("text")
            .text("value")
            .attr("fill", "black")
            .attr("transform", `rotate(270,${0},${110})`)

        body5.append("g")
            .attr("transform", "translate(0," + bodyHeight + ")")
            .call(d3.axisBottom(xScale))
            .append("text")
            .text("Year")
            .attr("fill", "black")
            .attr("dx", bodyWidth / 2)
            .attr("dy", 50)

        valueline_india = d3.line()
            .x(d => xScale(d.Year))
            .y(d => yScale(d.India))
        body5.append("path")
            .datum(data)
            .attr("d", d => valueline_india(d))
            .attr("class", "line_india")
        valueline_china = d3.line()
            .x(d => xScale(d.Year))
            .y(d => yScale(d.China))
        body5.append("path")
            .datum(data)
            .attr("d", d => valueline_china(d))
            .attr("class", "line_china")
        valueline_japan = d3.line()
            .x(d => xScale(d.Year))
            .y(d => yScale(d.Japan))
        body5.append("path")
            .datum(data)
            .attr("d", d => valueline_japan(d))
            .attr("class", "line_japan")
    }
</script>
</html>